<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Đang bận!</title>
<style>
  body {
    background-color: black; color: lime; font-family: monospace;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 100vh; text-align: center; padding: 20px;
  }
  h1 { color: red; animation: blink 1s infinite; }
  @keyframes blink { 0% {opacity: 1;} 50% {opacity: 0;} 100% {opacity: 1;} }
  #datetime { position: fixed; bottom: 10px; right: 20px; color: white; font-size: 14px; }
  input {
    padding: 5px; font-size: 14px; background: black; color: lime;
    border: 1px solid lime; text-align: center;
  }
  button {
    padding: 5px 10px; background: lime; color: black; border: none; cursor: pointer;
  }
  button:hover { background-color: red; color: white; }
</style>
</head>
<body>

<div id="formContainer">
  <h1>Nhập tên của bạn</h1>
  <form id="nameForm">
    <input type="text" id="nameInput" placeholder="Tên của bạn..." required>
    <button type="submit">Xác nhận</button>
  </form>
</div>

<div id="content" style="display:none;">
  <h1 id="title">⚠️ NGỦ ĐI ⚠️</h1>
  <p>haha...<span id="dots"></span></p>
  <div id="datetime"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyD962crs2BgxZIRQVYroUH4Ih4vL3VI_48",
  authDomain: "hihi-3c544.firebaseapp.com",
  databaseURL: "https://hihi-3c544-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "hihi-3c544",
  storageBucket: "hihi-3c544.firebasestorage.app",
  messagingSenderId: "799975042765",
  appId: "1:799975042765:web:d23ead7aa29deffcc0c384",
  measurementId: "G-W5FLH85R0R"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

signInAnonymously(auth).catch(console.error);

document.getElementById("nameForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const ten = document.getElementById("nameInput").value.trim();
  if (!ten) return;
  const payload = {
    name: ten,
    time: new Date().toLocaleString('vi-VN'),
    createdAt: Date.now()
  };
  try {
    await push(ref(db, "names"), payload);
    document.getElementById("title").textContent = `⚠️ ${ten.toUpperCase()}, NGỦ ĐI ⚠️`;
    document.getElementById("formContainer").style.display = "none";
    document.getElementById("content").style.display = "block";
  } catch (err) {
    alert("Không lưu được dữ liệu. Thử lại nhé!");
    console.error(err);
  }
});

let dots = document.getElementById('dots');
setInterval(() => {
  dots.textContent += '.';
  if (dots.textContent.length > 20) dots.textContent = '';
}, 300);

function updateDateTime() {
  const now = new Date();
  document.getElementById('datetime').textContent = now.toLocaleString('vi-VN', {
    weekday: 'long', year: 'numeric', month: 'long',
    day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit'
  });
}
setInterval(updateDateTime, 1000);
updateDateTime();
</script>
</body>
</html>

